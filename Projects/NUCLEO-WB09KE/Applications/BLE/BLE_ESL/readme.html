<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="../../../../../_htmresc/mini-st_2020.css">
</head>
<body>
<div class="row">
    <section id="markdown-content">
        <h2 id="ble_esl-application-description"><strong>BLE_ESL
        Application Description</strong></h2>
        <p>This example demonstrates how to use an STM32WB0 as
        Electronic Shelf Label device using Periodic Advertising with
        Responses (PAwR) feature. In particular, it implements the ESL
        role of the standard profile (Electronic Shelf Label, aka
        ESL).</p>
        <p>Each ESL device is addressed by a Group ID (7-bit value) and
        an ESL ID (8-bit value). Addresses are assigned by the ESL
        Access Point (AP) during the configuration phase of the node
        through the provisioning procedure. The ESL application starts
        as a simple Peripheral advertising. Once an ESL Access Point
        device connects to the Peripheral ESL, the ESL is provisioned
        with the information required to synchronize with the Access
        Point. This information consists of ESL address, key materials
        and absolute time. Using the Periodic Advertising Sync Transfer
        procedure, the ESL can synchronize with the periodic advertising
        train and then disconnect the link. In particular, the device
        synchronizes only with the PAwR subevent corresponding to the
        group (e.g. ESL in group 0 is synchronized only with subevent
        0). Once synchronized with the PAwR train, the ESL device can
        receive and execute ESL commands.</p>
        <p>The ESL can store some images in Flash. Images can be
        transferred from to the AP using the Object Transfer Profile. By
        default a maximum of three images can be saved.</p>
        <p>The following commands can be used for tests (working only if
        CFG_LPM_SUPPORTED is 0): - <em>ABSTIME</em>: Get Current
        Absolute Time - <em>SRVNEEDED</em>: Set Service Needed bit to
        True - <em>UNSYNC</em>: Set The ESL state to Unsynchronized</p>
        <h3 id="keywords"><strong>Keywords</strong></h3>
        <p>Connectivity, BLE, BLE protocol, BLE PAwR, ESL</p>
        <h3 id="hardware-and-software-environment"><strong>Hardware and
        Software environment</strong></h3>
        <ul>
        <li>This application runs on STM32WB0 Nucleo board.</li>
        <li>Another STM32WB0 Nucleo board is necessary to run BLE_ESL_AP
        application.</li>
        </ul>
        <h3 id="how-to-use-it"><strong>How to use it?</strong></h3>
        <p>In order to make the program work, you must do the
        following:</p>
        <ul>
        <li>Open the project with your preferred toolchain</li>
        <li>Rebuild all files and load your image into target memory
        (erase all the Flash before downloading, to initialize sectors
        used to store images)</li>
        <li>Run the example.</li>
        <li>Optionally, a serial terminal (with settings 921600-8-N-1),
        can be opened to see some info.</li>
        <li>Use another Nucleo board running BLE_ESL_AP.</li>
        <li>Add the ESL to the network by launching the appropriate
        command on the AP (e.g. AT+ADD).</li>
        <li>Once the BLE_ESL has been synchronized, ESL commands can be
        sent from the AP by specifying the assigned GROUP_ID and
        ESL_ID.</li>
        </ul>
        <p>For more info on how to send commands from the AP, see the
        related documentation.</p>
        <h3 id="notes"><strong>Notes</strong></h3>
        <p>ATTENTION: ESL removes any bonding information after a reset
        is performed and it becomes unassociated. This is required
        because the absolute time set by the AP is lost.</p>
        <p>When acting as a PAwR Observer, the Sleep Clock Accuracy must
        be under 50 ppm. The accuracy of the LSE on Nucleo-WB09KE meets
        this requirement in the range from 0 to 50 degree. If
        application needs to operate at a wider temperature range, it is
        suggested to enable the periodic calibration. LSI cannot be
        used.</p>
        <ul>
        <li>On Keil framework, the following compilation setting are
        applied:
        <ul>
        <li>diag_suppress L6312W (Hide “Empty &lt; type&gt; region
        description for region &lt; region&gt;” warning)</li>
        <li>diag_suppress L6314W (Hide “No section matches pattern &lt;
        module&gt;(&lt; section&gt;” warning)</li>
        <li>diag_suppress L6329W (Hide “Pattern &lt; module&gt;(&lt;
        section&gt;) only matches removed unused sections” warning)</li>
        </ul></li>
        </ul>
    </section>
</div>
</body>
</html>
